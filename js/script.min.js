const PHOTOS=[{index:0,bg:"#89979A",caption:"Kangchendzonga National Park, Sikkim, India"},{index:1,bg:"#6D86B8",caption:"Half Dome from Glacier Point, Yosemite National Park, California"},{index:2,bg:"#82B0D8",caption:"Blue Lake, John Muir Wilderness, Inyo National Forest, California"},{index:3,bg:"#B36F3C",caption:"Emerald Lake, Lakes Trail, Kings Canyon National Park, California"},{index:4,bg:"#2F343B",caption:"Horsetooth Mountain, Fort Collins, Colorado"},{index:5,bg:"#B8C9CC",caption:"Dolores Park, Mission, San Francisco, California"},{index:6,bg:"#8B6151",caption:"Kaibab National Forest, Grand Canyon, Arizona"},{index:7,bg:"#6C7971",caption:"Perugia, Cambria, Italy"},{index:8,bg:"#B26542",caption:"Alghero, Sardinia, Italy"},{index:9,bg:"#5E6C3C",caption:"Rifugio Menaggio, Lake Como, Italy"},{index:10,bg:"#5575C0",caption:"Puez-Geisler National Park, South Tyrol, Italy"},{index:11,bg:"#486BA1",caption:"Peak of Monte Grona, Lake Como, Italy"},{index:12,bg:"#7082A2",caption:"Puez-Geisler National Park, South Tyrol, Italy"},{index:13,bg:"#ADB9D1",caption:"Vembanad Lake, Cochin, Kerala, India"},{index:14,bg:"#6A723E",caption:"Angel Island State Park, San Francisco Bay, California"},{index:15,bg:"#8A7C4C",caption:"Soberanes Point, Carmel, Monterey, California"},{index:16,bg:"#EC965C",caption:"West Point Lighthouse, Discovery Park, Seattle, Washington"},{index:17,bg:"#D6D3CE",caption:"Wallace Falls State Park, Snohomish County, Washington"},{index:18,bg:"#9C7E52",caption:"Laguna Creek Beach, Santa Cruz, California"},{index:19,bg:"#CBAC86",caption:"Tent Rocks National Monument, Sandoval County, New Mexico"},{index:20,bg:"#454934",caption:"Gennargentu National Park, Cala Ganone, Sardinia, Italy"},{index:21,bg:"#94ABBD",caption:"McLaren Park, San Francisco, California"},{index:22,bg:"#2F3411",caption:"Angel Island State Park, San Francisco Bay, California"},{index:23,bg:"#A73E28",caption:"Prewitt Ridge, Big Sur, California"},{index:24,bg:"#536C8B",caption:"Yosemite Falls Trail, Yosemite National Park, California"},{index:25,bg:"#808B63",caption:"Kangchendzonga National Park, Sikkim, India"},{index:26,bg:"#546420",caption:"Briones Regional Park, Lafayette, California"},{index:27,bg:"#D8DEE0",caption:"Mendocino Headlands State Park, Mendocino, California"},{index:28,bg:"#709BC3",caption:"Four Mile Trail, Yosemite National Park, California"},{index:29,bg:"#E9906E",caption:"Shilshole Bay, Ballard, Seattle, Washington"}];const thumbs=document.querySelector(".thumbnails");const modal=document.querySelector(".photo-modal");function genThumbnails(){const e=2500;thumbs.innerHTML="";PHOTOS.sort(()=>{return.5-Math.random()});PHOTOS.forEach((a,t)=>{var n=Object.assign(document.createElement("div"),{className:`thumb-container fade-in delay-${t<18?e+parseInt(t*100):0}`,onclick:()=>openPhotoModal(t)});var o=Object.assign(document.createElement("img"),{className:"placeholder",src:`assets/photos/thumb/placeholder/${a.index}.svg`,style:`background-color: ${a.bg}`});n.appendChild(o);var i=Object.assign(document.createElement("img"),{className:"thumb",src:`assets/photos/thumb/${a.index}.jpg`});n.appendChild(i);thumbs.appendChild(n)});setTimeout(()=>{thumbs.querySelectorAll(".thumb-container").forEach(e=>{var a=e.querySelector(".placeholder");var t=e.querySelector(".thumb");var n=()=>{setTimeout(()=>{a.style.opacity=0;t.style.filter="blur(0px)"},1e3);setTimeout(()=>{a.style.display="none"},1500)};if(t.complete){n()}else{t.onload=(()=>{n()})}})},e+1e3)}function openPhotoModal(e){loadPhoto(e);animateIn(".photo-modal","slide-in-up",null,500);document.addEventListener("keydown",function e(a){if(a.keyCode===39)nextPhoto();if(a.keyCode===37)prevPhoto();if(a.keyCode===27){closePhotoModal();document.removeEventListener("keydown",e)}})}function closePhotoModal(){animateOut(".photo-modal","slide-out-bottom",()=>{modal.querySelector(".photo-container").style.backgroundImage="";modal.querySelector(".caption").innerHTML="";startLoadingAnimation()});history.pushState("","","#photos")}function nextPhoto(){if(active_photo+1>=PHOTOS.length||!modal.querySelector(".bar:last-of-type").classList.contains("done"))return;startLoadingAnimation();loadPhoto(++active_photo,500)}function prevPhoto(){if(active_photo<=0||!modal.querySelector(".bar:last-of-type").classList.contains("done"))return;startLoadingAnimation();loadPhoto(--active_photo,500)}function loadPhoto(e,a=0){Object.assign(document.createElement("img"),{src:`assets/photos/${PHOTOS[e].index}.jpg`,onload:()=>{setTimeout(()=>{modal.querySelector(".photo-container").style.backgroundImage=`url('assets/photos/${PHOTOS[e].index}.jpg')`;endLoadingAnimation();track(identifyPhoto(PHOTOS[e]))},a)},onerror:()=>{endLoadingAnimation()}});history.pushState("","",`#photos?${e+1}`);modal.querySelector(".caption").innerHTML=formatCaptions(PHOTOS[e].caption);active_photo=e;var t=modal.querySelector(".modal-next-btn");var n=modal.querySelector(".modal-prev-btn");if(active_photo+1>=PHOTOS.length){t.classList.add("disabled")}else if(active_photo<=0){n.classList.add("disabled")}else{t.classList.remove("disabled");n.classList.remove("disabled")}}function endLoadingAnimation(){var e=modal.querySelectorAll(".bars div");var a=e.length;var t=0;e.forEach((e,n)=>{e.addEventListener("animationiteration",function o(i){if(n===0||t>0){i.target.classList.add("done");t++;e.removeEventListener("animationiteration",o)}if(t>=a){modal.classList.add("loaded")}})})}function startLoadingAnimation(){modal.classList.remove("loaded");modal.querySelectorAll(".bars div").forEach((e,a)=>{setTimeout(()=>{e.classList.remove("done")},a*100)})}function formatCaptions(e){var a=e.lastIndexOf(",",e.lastIndexOf(",")-1)+1;return e.substr(0,a)+"<br>"+e.substr(a)}function identifyPhoto(e){return`${e.index}.jpg - ${e.caption.substr(0,e.caption.lastIndexOf(",",e.caption.lastIndexOf(",")-1))}`}var map,currentMapLayer,currentMapLayerName,paths=[];function initializeMap(){L.mapbox.accessToken="pk.eyJ1Ijoicm9oYW5iMTAiLCJhIjoiY2thaDZxaHFvMGRoaDJzbzBtczM3YjNneiJ9.Wza5G0LIJQ8hZjAYsFobYg";map=L.mapbox.map("map").setView([37.7906,-122.4482],12).setMaxZoom(15).setMinZoom(10).setMaxBounds([[[37.196,-121.609],[38.225,-123.036]]]);currentMapLayerName="light";currentMapLayer=L.mapbox.styleLayer(mapLayers[currentMapLayerName]);map.addLayer(currentMapLayer);checkMapLayerColor();map.attributionControl.remove()}function updateMap(e){var a=e.getAttribute("data-ride-id");if(a==="all"){drawAll();track(`Maps - all selected`);return}else if(a==="random"){drawSnake(getRandomPath());return}else if(RIDES[a]===undefined){return}drawSnake(a)}var mapLayers={light:"mapbox://styles/mapbox/light-v10",dark:"mapbox://styles/mapbox/dark-v10"};function checkMapLayerColor(){if(!map)return;if(currentMapLayerName==="custom")return;var e=isDark(document.documentElement.style.getPropertyValue("--c-3"))?"light":"dark";if(e===currentMapLayerName)return;if(currentMapLayerName.length>1)mapContainer.classList.remove(currentMapLayerName);var a=L.mapbox.styleLayer(mapLayers[e]);map.addLayer(a).removeLayer(currentMapLayer);mapContainer.classList.add(e);currentMapLayer=a;currentMapLayerName=e;return}function clearPaths(){if(!map)return;paths.forEach(e=>{e.remove(map)});paths=[]}function drawSnake(e){if(!map)return;clearPaths();var a=L.polyline(decodePath(RIDES[e]),{className:"path-single",stroke:"--var(--c-3)"});paths.push(a);map.fitBounds(a.getBounds(),{padding:[10,10],animate:true,pan:{duration:1}});map.once("moveend",()=>{a.addTo(map);var e=a._path.getTotalLength();Object.assign(a._path.style,{opacity:0,transitionProperty:"stroke-dashoffset",transitionDuration:"1ms",transitionTimingFunction:"linear",strokeDashoffset:e,strokeDasharray:e});setTimeout(()=>{Object.assign(a._path.style,{opacity:.7,transitionDuration:`${getTransitionDuration(a)}s`,strokeDashoffset:0});disableMapInteractions();a._path.addEventListener("transitionend",()=>{a._path.style.strokeDasharray="unset";enableMapInteractions()})},150)})}function drawAll(){clearPaths();map.flyTo([37.7906,-122.4482],12);map.once("moveend",()=>{for(var e of Object.keys(RIDES)){var a=L.polyline(decodePath(RIDES[e]),{className:"path-all",stroke:"--var(--c-3)"});a.addTo(map);paths.push(a)}})}function drawRandom(e){e.classList.add("spin");e.addEventListener("animationend",()=>{e.classList.remove("spin")},{once:true});drawSnake(getRandomPath())}function getRandomPath(){if(!map)return;var e,a=0;var t=Math.random()<.75?1e4:Math.random()<.67?7500:5e3;var n=Object.keys(RIDES);while(a<t){e=n[n.length*Math.random()<<0];a=calcDistance(L.polyline(decodePath(RIDES[e])))}return e}function calcDistance(e){if(!map)return;var a=e._latlngs[0];var t=0;e._latlngs.forEach(e=>{t+=a.distanceTo(e);a=e});return parseInt(t)}function getTransitionDuration(e){var a=calcDistance(e)/2e3;return a<=10?10:a}function disableMapInteractions(){if(!map)return;mapContainer.classList.add("waiting");map.dragging.disable();map.touchZoom.disable();map.doubleClickZoom.disable();map.scrollWheelZoom.disable();map.keyboard.disable();if(map.tap)map.tap.disable()}function enableMapInteractions(){if(!map)return;mapContainer.classList.remove("waiting");map.dragging.enable();map.touchZoom.enable();map.doubleClickZoom.enable();map.scrollWheelZoom.enable();map.keyboard.enable();if(map.tap)map.tap.enable()}function changeMapLayer(e){nextMapLayer=L.mapbox.styleLayer(e);currentMapLayerName="custom";map.addLayer(nextMapLayer).removeLayer(currentMapLayer);currentMapLayer=nextMapLayer}function decodePath(e){var a=0,t=0,n=0,o=[],i=0,r=0,s=null,c,l,d=1e5;while(a<e.length){s=null;i=0;r=0;do{s=e.charCodeAt(a++)-63;r|=(s&31)<<i;i+=5}while(s>=32);c=r&1?~(r>>1):r>>1;i=r=0;do{s=e.charCodeAt(a++)-63;r|=(s&31)<<i;i+=5}while(s>=32);l=r&1?~(r>>1):r>>1;t+=c;n+=l;o.push([t/d,n/d])}return o}const COLOUR_SCHEMES=[["rgb( 76,187,185)","rgb(255,190,105)","rgb(152,214,234)","rgb(255, 99, 99)","rgb(133,102,170)"],["rgb(239,194,184)","rgb(149,187,217)","rgb(188,220,150)","rgb(238,222,151)","rgb(214,217,253)"],["rgb(240, 92,136)","rgb(111,125,246)","rgb(119,203,249)","rgb(255,168,  5)","rgb( 66,199,153)"],["rgb(  6,140,175)","rgb( 17,183,158)","rgb(233,178,188)","rgb(219,188,118)","rgb(146,129,161)"],["rgb(254,138,138)","rgb(127,102,152)","rgb(250,210,109)","rgb(127,182,161)","rgb(139,197,217)"],["rgb(145, 48, 48)","rgb( 39, 90,119)","rgb( 36,107, 80)","rgb(194,129, 71)","rgb(112, 72,111)"]];function changeColours(e){var a=document.documentElement;var t="New Colours: ";e.forEach((e,n)=>{e=`rgb(${+`0x${e[1]}${e[2]}`},${+`0x${e[3]}${e[4]}`},${+`0x${e[5]}${e[6]}`})`;a.style.setProperty(`--c-${n}`,e);t+=e+", "});currentScheme=-1;return t}function rgbArray(e){e=e.substr(4).split(")")[0].split(",");return[parseInt(e[0]),parseInt(e[1]),parseInt(e[2])]}function transitionColourScheme(e,a=true,t){if(e<0||e>=COLOUR_SCHEMES.length)return"Please enter a valid index";var n=[],o=[],i=[],r=0;var s=COLOUR_SCHEMES[e];if(a)s.sort(()=>{return.5-Math.random()});var c=document.documentElement.style;s.forEach((e,a)=>{n.push(rgbArray(e));o.push(rgbArray(c.getPropertyValue(`--c-${a}`)))});o.forEach((e,a)=>{i[a]=setInterval(()=>{e.forEach((t,o)=>{e[o]=t>n[a][o]?t-1:t<n[a][o]?t+1:t});c.setProperty(`--c-${a}`,`rgb(${e[0]},${e[1]},${e[2]})`);if(e[0]===n[a][0]&&e[1]===n[a][1]&&e[2]===n[a][2]){clearInterval(i[a]);if(++r>=n.length&&t)t()}},1)})}function changeColourScheme(e,a=true,t){if(e<0||e>=COLOUR_SCHEMES.length)return"Please enter a valid index";var n=COLOUR_SCHEMES[e||currentScheme];if(a)n.sort(()=>{return.5-Math.random()});var o=document.documentElement;n.forEach((e,a)=>{o.style.setProperty(`--c-${a}`,e)});if(t)t()}function nextColourSchemeID(){return currentScheme+1<COLOUR_SCHEMES.length?currentScheme+1:0}function isDark(e){var a=rgbArray(e);return a[0]*.299+a[1]*.587+a[2]*.114<=186}function bucket(e){if(e.parentElement.classList.contains("changing"))return;var a=nextColourSchemeID();e.parentElement.classList.add("changing");var t=()=>{checkMapLayerColor();setTimeout(()=>{e.parentElement.classList.remove("changing");changeBucketColours(nextColourSchemeID())},1200)};if(active_section!==null){transitionColourScheme(a,true,()=>{ripple();t()})}else{var n=navbar.querySelector(".section-title.wave");killWave();setTimeout(()=>{changeColourScheme(a,true,()=>{startWave(1);t()})},n?450:0)}currentScheme=a;track(`Colour Changed: ${currentScheme}`,"#bucket")}function changeBucketColours(e){var a=document.querySelector(".bucket");COLOUR_SCHEMES[e].forEach((e,t)=>{a.style.setProperty(`--nc-${t}`,e)})}var currentScheme=0;changeColourScheme(currentScheme);changeBucketColours(nextColourSchemeID());var navbar,navbarSections,names,mapContainer,active_section=null,active_work="",active_photo=null;history.pushState(null,null,window.location.pathname);window.addEventListener("popstate",()=>{navbarSections.forEach(e=>{e.classList.remove("active")});hideAllSections()});var wave,swell,tide,crests=[],troughs=[];function ripple(e=0){clearTimeout(swell);swell=setTimeout(function(){navbarSections.forEach((e,a,t)=>{crests[a]=setTimeout(rippleUp,150*a,e,names[a]);troughs[a]=setTimeout(rippleDown,t.length*150+200*a,e,names[a])})},e)}function rippleUp(e,a){e.classList.add("wave");if(a)a.classList.add("wave")}function rippleDown(e,a){e.classList.remove("wave");if(a)a.classList.remove("wave")}function startWave(e=0){if(e>0)ripple(e);clearInterval(wave);clearTimeout(tide);tide=setTimeout(()=>{wave=setInterval(ripple,4e3)},e)}function killWave(e){clearTimeout(tide);clearTimeout(swell);clearInterval(wave);navbarSections.forEach((a,t)=>{clearTimeout(crests[t]);if(t===e){clearTimeout(troughs[t])}else{rippleDown(a,names[t])}})}function navControl(e){var a=e.querySelector("span").getAttribute("data-section-id");var t=e.querySelector("span").getAttribute("data-section-name");killWave();navbar.classList.remove("active");navbarSections.forEach(e=>{e.classList.remove("active")});if(a===active_section){hideAllSections()}else{showSection(a);navbar.setAttribute("data-bg-color",e.getAttribute("data-bg-color"));navbar.setAttribute("data-open","true");navbar.classList.add("active");e.classList.add("active");document.getElementById("section-container").classList.add("active");history.pushState("","",`#${t}`);track(t)}}var mapFilesLoadedCount=0;function showSection(e){switch(e){case"id-work":loadFile("smoothscroll-polyfill","js");if(active_work==="")break;document.querySelector(".work.active").classList.remove("active");document.getElementById(active_work).classList.add("hidden");active_work="";break;case"id-skills":document.querySelectorAll(".img-skill").forEach(e=>{e.src=e.getAttribute("data-src")});break;case"id-photos":closePhotoModal();genThumbnails();break;case"id-maps":mapContainer.classList.remove("fade-in");mapFilesLoadedCount=0;loadFile("rides","js");loadFile("mapbox","js","https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.js");loadFile("mapbox","css","https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.css");setTimeout(()=>{var e=setInterval(()=>{if(mapFilesLoadedCount>=3){if(map===undefined)initializeMap();mapContainer.classList.add("fade-in");clearTimeout(e)}},250)},1500);break;case"id-about":document.getElementById("me-jpg").src="assets/me.jpg";document.getElementById("me-gif").src="assets/me.gif";break}if(active_section===null){toggleHero();setTimeout(()=>{document.getElementById(e).classList.remove("hidden")},1e3)}else{window.scroll({top:0,left:0,behavior:"smooth"});animateOut(`#${active_section}`,"fade-out-bottom",()=>{document.getElementById(e).classList.remove("hidden")})}active_section=e}function toggleHero(){var e=document.querySelector("#hero");if(e.style.height===`0px`){e.style.height=`calc(var(--vh, 1vh) * 60)`}else{e.style.height="0px"}}function loadFile(e,a,t){if(document.querySelectorAll(`.${a}-${e}`).length>0){mapFilesLoadedCount++;return}var n=Object.assign(document.createElement(a==="js"?"script":"link"),{...a==="js"&&t===undefined?{src:`js/${e}.js`}:{},...a==="js"&&t!==undefined?{src:t}:{},...a==="css"?{rel:"stylesheet"}:{},...a==="css"&&t===undefined?{href:`css/${e}.css`}:{},...a==="css"&&t!==undefined?{href:t}:{},className:`${a}-${e}`});n.onload=(()=>{mapFilesLoadedCount++});if(a==="js")document.body.appendChild(n);if(a==="css")document.head.appendChild(n)}function hideAllSections(){navbar.setAttribute("data-open","false");document.getElementById("section-container").classList.remove("active");toggleHero();killWave();startWave(1500);history.pushState(null,null,window.location.pathname);animateOut("#"+active_section,"fade-out-bottom");active_section=null;track("Back to Home","#home")}function highTide(){killWave();navbarSections.forEach((e,a,t)=>{setTimeout(rippleUp,150*a,e,names[a])})}function workPicker(e,a){if(active_work===a)return;var t=document.getElementById(a);if(active_work===""){t.classList.remove("hidden")}else{document.querySelector(".work.active").classList.remove("active");animateOut(`#${active_work}`,"fade-out-right",()=>{t.classList.remove("hidden")})}e.classList.add("active");active_work=a;if(window.innerWidth<=640){t.parentElement.scrollIntoView({behavior:"smooth"})}history.pushState("","",`#work?${a}`);track(`Work - ${a}`)}function track(e,a=false){if(window.location.protocol=="file:"){console.log(`Clicky | ${a?a:window.location.hash} | ${e}`);return}if(typeof clicky==="undefined")return;clicky.log(a?a:window.location.hash,e)}function stopTracking(){track=(()=>{return})}function animateOut(e,a,t,n=500){var o=document.querySelector(e);o.classList.add(a);setTimeout(()=>{o.classList.remove(a);o.classList.add("hidden");if(t)t()},n,o,a,t)}function animateIn(e,a,t,n=500){var o=document.querySelector(e);o.classList.remove("hidden");o.classList.add(a);setTimeout(()=>{o.classList.remove(a)},n,o);if(t)t()}var debounced;function mobileViewportHack(){document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`)}var window_height=window.innerHeight;window.addEventListener("resize",e=>{if(window.innerHeight===window_height)return;clearTimeout(debounced);debounced=setTimeout(mobileViewportHack,100)});mobileViewportHack();window.addEventListener("orientationchange",mobileViewportHack);document.querySelectorAll(".social a").forEach(e=>{e.addEventListener("click",()=>{track(`Social clicked - ${e.getAttribute("data-name")?e.getAttribute("data-name"):e.hostname}`)})});document.addEventListener("DOMContentLoaded",()=>{navbar=document.getElementById("navigation");navbarSections=navbar.querySelectorAll(".section-title");names=document.querySelectorAll("#hero span span");mapContainer=document.querySelector(".map-container");navbarSections.forEach((e,a)=>{e.addEventListener("mouseover",()=>{killWave(a);if(active_section===null)names[a].classList.add("wave")});e.addEventListener("mousemove",()=>{if(active_section===null)names[a].classList.add("wave")});e.addEventListener("mouseout",()=>{killWave();if(active_section===null)startWave(1500)})});startWave(1e3)},false);